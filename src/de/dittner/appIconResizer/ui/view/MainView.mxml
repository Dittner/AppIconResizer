<?xml version="1.0"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         xmlns:input="de.dittner.appIconResizer.ui.common.input.*" xmlns:button="de.dittner.appIconResizer.ui.common.button.*"
         mouseEnabled="{!vm.isProcessing}"
         mouseChildren="{!vm.isProcessing}">

    <fx:Script><![CDATA[
        import de.dittner.appIconResizer.model.AppModel;

        //--------------------------------------
        //  vm
        //--------------------------------------
        private var _vm:AppModel;
        [Bindable("vmChanged")]
        public function get vm():AppModel {return _vm;}
        public function set vm(value:AppModel):void {
            if (_vm != value) {
                _vm = value;
                dispatchEvent(new Event("vmChanged"));
            }
        }

        private function generateIconsBtnEnabled(selectedIcon:BitmapData, iconSizes:String, iconNameTemplate:String):Boolean {
            return selectedIcon && iconSizes.length > 2 && iconNameTemplate.indexOf("SIZE") != -1;
        }
        ]]></fx:Script>
    <s:layout>
        <s:VerticalLayout horizontalAlign="center" gap="20"
                          paddingBottom="50" paddingTop="50" paddingLeft="20" paddingRight="20"/>
    </s:layout>

    <s:Group width="250" height="250">
        <s:BitmapImage id="bg"
                       source="@Embed(source='/assets/empty_icon_bg.png')"/>

        <s:BitmapImage id="selectedIcon"
                       fillMode="scale"
                       source="{vm.selectedIcon}"
                       width="100%"
                       height="100%"/>

        <!--<s:BitmapImage source="@Embed(source='/assets/shadow.png')"
                       width="100%"/>-->

    </s:Group>

    <button:WhiteButton label="Select PNG-File" width="250"
                        click="vm.selectIcon()"/>

    <s:Spacer height="100%"/>

    <input:TextInputForm id="iconSizesInput"
                         restrict="0-9, "
                         title="Icon sizes" width="600" text="@{vm.iconSizes}"/>

    <input:TextInputForm title="Icon's template of name (use constant SIZE as icon's size)"
                         width="600" text="@{vm.iconNameTemplate}"/>

    <input:TextInputForm title="Log's item template (use constant SIZE as icon's size)"
                         width="600" text="@{vm.logItemTemplate}"/>

    <s:Spacer height="100%"/>

    <button:RedButton label="Generate"
                      width="250"
                      enabled="{generateIconsBtnEnabled(vm.selectedIcon, vm.iconSizes, vm.iconNameTemplate)}"
                      click="vm.generateIcons()"/>

    <s:Label width="500"
             color="#ffFFff"
             fontSize="16"
             textAlign="center"
             text="{vm.processingInfo}"/>

</s:Group>
